name: Regression Tests

on:
  pull_request:
    types: [opened, reopened]
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
    build:
        name: build
        uses: ./.github/workflows/continuous-integration.yml
    regression-test:
        name: regression-test
        runs-on: ubuntu-latest
        permissions:
          id-token: write
          contents: read
        steps:
          - name: Regression testing
            run: |
              export BASE_URL=$(make get-url)
              echo API base url = $BASE_URL

              source .venv/bin/activate && python runner.py --tags ~bug
